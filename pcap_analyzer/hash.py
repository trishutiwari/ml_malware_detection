def get_payload(pkt):
    """
    Fetch the payload from the highest layer.

    :param pkt:
    :return:
    """
    while pkt.payload:
        pkt = pkt.payload
    return str(pkt)


def calculate_hash(session_obj, new_session):
    """
    Function to calculate/update the hash.

    :param session_obj:
    :param new_session:
    :return:
    """
    for packet in new_session:
        session_obj[5].update(get_payload(packet))
    return session_obj
