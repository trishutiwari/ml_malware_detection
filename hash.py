_MINHASH_INDEX = 3

def get_payload(pkt):
    """
    Fetch the everything from layer 3 and above (network layer +)

    :param pkt:
    :return:
    """
    for i in range(2):
        pkt = pkt.payload
    try:
    	return pkt.encode('utf-8')
    except Exception as e:
    	return str(pkt).encode('utf-8')


def calculate_hash(session_obj, new_session):
    """
    Function to calculate/update the hash.

    :param session_obj:
    :param new_session:
    :return:
    """
    for packet in new_session:
        session_obj[_MINHASH_INDEX].update(get_payload(packet))
    return session_obj
